Race Condition Exploitation â€“ Web Application Checkout Logic
Objective

Identify and exploit a race condition vulnerability in a web application checkout flow that allows multiple purchases of a limited-stock item, resulting in negative inventory values.

Tools Used

Burp Suite (Proxy, Repeater)

Firefox (AttackBox)

FoxyProxy

Linux AttackBox (TryHackMe)

Environment Setup
1. Configure Browser Proxy

Open Firefox on the AttackBox.

Enable Burp routing using FoxyProxy.

Select the Burp profile so all traffic is sent through Burp Suite.

ðŸ“¸ Screenshot: FoxyProxy enabled with Burp profile selected

2. Launch Burp Suite

Open Burp Suite from the desktop.

Select Temporary project (in memory).

Click Start Burp.

ðŸ“¸ Screenshot: Burp Suite startup screen

3. Disable Intercept

Navigate to Proxy â†’ Intercept.

Ensure the button shows Intercept off.

ðŸ“¸ Screenshot: Intercept disabled in Burp

Baseline Application Interaction
4. Authenticate to the Web Application

Visit http://MACHINE_IP

Log in using:

Username: attacker

Password: attacker@123

ðŸ“¸ Screenshot: Successful login dashboard

5. Perform a Legitimate Purchase

Identify the limited-stock item (SleighToy â€“ 10 units available).

Click Add to Cart.

Proceed to Checkout.

Click Confirm & Pay.

ðŸ“¸ Screenshot: Successful checkout confirmation

This request is used as the baseline for exploitation.

Capturing the Checkout Request
6. Locate the Checkout Request

In Burp Suite, go to Proxy â†’ HTTP history.

Identify the POST request to:

/process_checkout


Right-click the request and select Send to Repeater.

ðŸ“¸ Screenshot: POST /process_checkout request in HTTP history

Race Condition Exploitation
7. Prepare Parallel Requests

Navigate to the Repeater tab.

Right-click the request tab â†’ Add tab to group.

Name the group:

cart


ðŸ“¸ Screenshot: Repeater tab group created

8. Duplicate Requests

Right-click the request tab â†’ Duplicate tab

Create 15 identical requests inside the cart group.

ðŸ“¸ Screenshot: Multiple duplicated requests in Repeater

9. Send Requests in Parallel

In Repeater toolbar:

Click Send â–¼

Select Send group in parallel (last-byte sync)

Click Send group (parallel)

This forces the backend to process multiple checkout requests simultaneously.

ðŸ“¸ Screenshot: Parallel requests executing in Repeater

Impact Verification
10. Confirm Exploitation

Return to the web application dashboard.

Observe:

Multiple successful orders

Inventory reduced below zero

ðŸ“¸ Screenshot: Negative stock value displayed

Result

The application failed to properly synchronize inventory updates during concurrent checkout requests. Each request was processed independently before stock validation completed, allowing overselling.

Root Cause

No atomic transaction handling during checkout

Stock validation performed before final commit

No concurrency or idempotency protection on payment endpoint

Mitigation Recommendations

Use atomic database transactions to ensure stock deduction and order creation occur as one operation.

Revalidate stock at commit time, not before.

Implement idempotency keys on checkout requests.

Apply rate limiting or concurrency locks on sensitive endpoints.

Skills Demonstrated

Web application traffic analysis

Burp Suite Repeater advanced usage

Race condition exploitation

Application logic abuse

Security impact validation

Defensive mitigation mapping
