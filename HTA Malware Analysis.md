HTA Malware Analysis â€“ Phishing-Based Initial Access
Objective
Analyse a suspicious HTA file delivered via phishing to determine its behaviour, execution flow, and potential data exfiltration or second-stage payload activity.

Initial Assessment
The file under investigation was an HTA (HTML Application) attached to a salary survey email. HTA files execute via mshta.exe, allowing embedded scripts to run with user-level privileges outside the browser context. This immediately raised concern for initial access via script-based execution.
To avoid execution, the file was opened strictly in a text editor for static analysis.

Metadata Review
Inspection of the <head> section showed misleading metadata intended to appear legitimate (survey-style naming and benign UI properties). This aligns with common phishing tactics where attacker intent is hidden behind business-themed lures.
Key takeaway: Metadata did not match behaviour observed in the script logic.

Script Analysis (VBScript)
The active logic resides within <script type="text/vbscript">. I identified five core functions:


window_onLoad
Auto-executes on launch. Triggers the entire infection chain without user interaction.


getQuestions
Makes outbound requests, processes encoded data, and passes decoded content downstream.


provideFeedback
Collects host-level information and initiates execution logic. This function is responsible for chaining data collection and payload execution.


decodeBase64
Decodes embedded Base64 strings, a clear obfuscation attempt.


RSBinaryToString
Converts decoded binary data back into executable string format.


This structure indicates deliberate staging rather than simple survey logic.

Suspicious Objects and Capabilities
Several COM objects were instantiated using CreateObject(), each indicating malicious capability:


InternetExplorer.Application
Used to initiate external network connections.


WScript.Network
Used to collect system and network-level information.


WScript.Shell
Enables command execution on the host.


