HTA Malware Analysis â€“ Phishing-Based Initial Access
Objective
Analyse a suspicious HTA file delivered via phishing to determine its behaviour, execution flow, and potential data exfiltration or second-stage payload activity.

Initial Assessment
The file under investigation was an HTA (HTML Application) attached to a salary survey email. HTA files execute via mshta.exe, allowing embedded scripts to run with user-level privileges outside the browser context. This immediately raised concern for initial access via script-based execution.
To avoid execution, the file was opened strictly in a text editor for static analysis.

Metadata Review
Inspection of the <head> section showed misleading metadata intended to appear legitimate (survey-style naming and benign UI properties). This aligns with common phishing tactics where attacker intent is hidden behind business-themed lures.
Key takeaway: Metadata did not match behaviour observed in the script logic.

Script Analysis (VBScript)
The active logic resides within <script type="text/vbscript">. I identified five core functions:


window_onLoad
Auto-executes on launch. Triggers the entire infection chain without user interaction.


getQuestions
Makes outbound requests, processes encoded data, and passes decoded content downstream.


provideFeedback
Collects host-level information and initiates execution logic. This function is responsible for chaining data collection and payload execution.


decodeBase64
Decodes embedded Base64 strings, a clear obfuscation attempt.


RSBinaryToString
Converts decoded binary data back into executable string format.


This structure indicates deliberate staging rather than simple survey logic.

Suspicious Objects and Capabilities
Several COM objects were instantiated using CreateObject(), each indicating malicious capability:


InternetExplorer.Application
Used to initiate external network connections.


WScript.Network
Used to collect system and network-level information.


WScript.Shell
Enables command execution on the host.

The combination strongly suggests environment reconnaissance followed by payload execution.

Obfuscation and Payload Execution
Within the script, a Base64-encoded string was identified and extracted. Decoding revealed a remote URL used to retrieve additional content.
Execution flow observed:


Base64 string decoded into a URL.


Remote content fetched via HTTP.


Content stored in memory.


Content converted into a scriptblock.


Script executed in memory via PowerShell.


This confirms fileless execution and aligns with living-off-the-land techniques using:


mshta.exe


powershell.exe


No binary was written to disk at this stage.

User Interface Review
The <body> section presented a simple survey-style interface consistent with the phishing lure. No visible indicators suggested malicious behaviour to the end user.
This supports high social engineering effectiveness combined with silent background execution.

Findings Summary


HTA file acts as an initial access loader


Auto-executes on open via window_onLoad


Uses VBScript + PowerShell for staged execution


Employs Base64 obfuscation


Retrieves and executes remote payloads in memory


Performs host reconnaissance


Uses trusted Windows binaries to evade detection







