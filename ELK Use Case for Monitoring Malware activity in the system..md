Lab Walkthrough
Step 1: Access the Windows Server

Click WinServer2012

If already running, skip to login

Click Ctrl + Alt + Delete

Login with:

Username: Admin

Password: Pa$$w0rd

Step 2: Prepare the Malware Sample

Navigate to:
E:\SOC-Tools\Module 05 Enhance Incident Detection with Threat Intelligence

Copy the wikiworm folder

Paste the folder into the *C:* drive

Step 3: Execute the Malware Sample

Navigate to C:\wikiworm

Double-click wikiworm.exe

When prompted, click OK

This action generates Sysmon logs that will later be analyzed in the SIEM.

Step 4: Access Security Onion and Kibana

Launch the Security Onion machine

Open Kibana from the desktop

Login with:

Username: martin

Password: martin@123

Step 5: Search for Malware Activity in Kibana

Open Discover

Search for:

wikiworm.exe


Click Update

Step 6: Apply a Filter for Precise Detection

Click Add a filter +

Configure the filter:

Field: event_data.Image

Operator: is

Value: C:\Wikiworm\wikiworm.exe

Click Save

This narrows the view to the exact execution event of the suspicious file.

Step 7: Extract the File Hash

Expand the event details

Locate event_data.Hashes

Copy the MD5 hash

The value appears between MD5= and ,

Step 8: Validate the Hash Using VirusTotal

Open a new browser tab

Navigate to:
http://www.virustotal.com

Paste the copied hash into the search bar

Press Enter

Step 9: Review Malware Intelligence

VirusTotal correlates the hash against known malware signatures

The report confirms the file is associated with a worm

Detection results include:

Malware classification

Detection ratio

Threat intelligence context

Outcome

Successfully detected malware execution using Sysmon logs

Extracted file hash from SIEM data

Confirmed malware via VirusTotal

Demonstrated a complete hash-based malware detection workflow using ELK
